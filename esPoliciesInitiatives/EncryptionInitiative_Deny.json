{
  "properties": {
    "Description": "Deny or Audit resources without Encryption",
    "DisplayName": "Deny or Audit resources without Encryption",
    "Parameters": {
      "ADXdiskEncryptedEffect": {
        "metadata": {
          "description": "Disk encryption should be enabled on Azure Data Explorer",
          "displayName": "Enabling disk encryption helps protect and safeguard your data to meet your organizational security and compliance commitments."
        },
        "type": "String",
        "defaultValue": "Deny",
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ]
      },
      "AutomationAuditUnencryptedVarsEffect": {
        "type": "string",
        "defaultValue": "Deny",
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Automation account variables should be encrypted",
          "description": "It is important to enable encryption of Automation account variable assets when storing sensitive data"
        }
      },
      "CognitiveServicesEncryptionEffect": {
        "type": "string",
        "defaultValue": "Audit",
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Cognitive Services accounts should enable data encryption",
          "description": "This policy audits any Cognitive Services account not using data encryption. For each Cognitive Services account with storage, should enable data encryption with either customer managed or Microsoft managed key."
        }
      },
      "EncryptedVMDisksEffect": {
        "type": "string",
        "defaultValue":  "AuditIfNotExists",
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "displayName": "Disk encryption should be applied on virtual machines",
          "description": "Virtual machines without an enabled disk encryption will be monitored by Azure Security Center as recommendations."
        }
      }
    },
    "PolicyDefinitionGroups": null,
    "PolicyDefinitions": [
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f4b53539-8df9-40e4-86c6-6b607703bd4e",
        "policyDefinitionReferenceId": "ADXdiskEncrypted",
        "parameters": {
          "effect": {
            "value": "[parameters('ADXdiskEncryptedEffect')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735",
        "policyDefinitionReferenceId": "AutomationAuditUnencryptedVars",
        "parameters": {
          "effect": {
            "value": "[parameters('AutomationAuditUnencryptedVarsEffect')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2bdd0062-9d75-436e-89df-487dd8e4b3c7",
        "policyDefinitionReferenceId": "CognitiveServicesEncryption",
        "parameters": {
          "effect": {
            "value": "[parameters('CognitiveServicesEncryptionEffect')]"
          }
        }
      },
      {
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d",
        "policyDefinitionReferenceId": "EncryptedVMDisksEffect",
        "parameters": {
          "effect": {
            "value": "[parameters('EncryptedVMDisksEffect')]"
          }
        }
      }
    ],
    "metadata": {
      "version": "1.0.0",
      "category": "Encryption"
    }
  },
  "id": "/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Encryption",
  "type": null,
  "name": "Enforce-Encryption"
}